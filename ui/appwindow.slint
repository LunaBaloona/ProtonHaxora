import { Button, LineEdit, VerticalBox, ScrollView } from "std-widgets.slint";

export component AppWindow inherits Window {
    title: "protonhaxora v0.5.3";
    icon: @image-url("icon.png");
    min_width: 450px;
    min_height: 500px;

    in property <[string]> game_names: [];
    in-out property <string> app_id <=> input_id.text;
    in-out property <string> search_text;

    callback run_protonhax(string);
    callback game_selected(string);
    callback search_edited(string);

    VerticalBox {
        padding: 20px;
        spacing: 12px;

        Text { text: "Search & Select Game:"; font-size: 14px; }

        LineEdit {
            placeholder-text: "Type to search...";
            text <=> root.search_text;
            edited(text) => {
                root.search_edited(text);
            }
        }

        Rectangle {
            background: #2a2a2a;
            border-radius: 4px;
            height: 180px;
            ScrollView {
                VerticalBox {
                    padding: 5px;
                    alignment: start;
                    for name in root.game_names : Button {
                        text: name;
                        clicked => {
                            root.game_selected(name);
                            root.search_text = name;
                        }
                    }
                }
            }
        }

        Text { text: "App ID:"; font-size: 14px; }
        input_id := LineEdit {
            placeholder-text: "App ID";
            font-size: 16px;
        }

        VerticalBox {
            padding: 0;
            spacing: 5px;
            Text {
                text: "Add this line to the game's Launch Options in Steam first:";
                font-size: 11px;
                wrap: word-wrap;
            }
            LineEdit {
                text: "protonhax init %COMMAND%";
                read-only: true;
            }
        }

        Text {
            text: "Press Launch, then press F1 at the game's menu to launch Aurora";
            font-size: 11px;
            color: #3498db;
            wrap: word-wrap;
            horizontal-alignment: center;
        }

        Button {
            text: "Launch";
            primary: true;
            clicked => {
                root.run_protonhax(root.app_id);
            }
        }
    }
}
